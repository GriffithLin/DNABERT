2023-10-26 11:36:47,013 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
2023-10-26 11:36:49,835 - INFO - __main__ -   finish loading model
2023-10-26 11:36:51,778 - INFO - __main__ -   Training/evaluation parameters Namespace(adam_epsilon=1e-08, attention_probs_dropout_prob=0.1, beta1=0.9, beta2=0.999, cache_dir='', config_name='', data_dir='/data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after', device=device(type='cuda'), do_ensemble_pred=False, do_eval=True, do_lower_case=False, do_predict=False, do_train=True, do_visualize=False, early_stop=0, eval_all_checkpoints=False, evaluate_during_training=True, filter_num=128, filter_size=[2, 3, 4, 5, 6], fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, hidden_dropout_prob=0.1, learning_rate=0.0001, local_rank=-1, logging_steps=100, max_grad_norm=1.0, max_seq_length=250, max_steps=-1, model_name='mutant_Bert_100_2506+10020_5_dnatextcnn', model_name_or_path='/data3/linming/DNABERT/examples/embeding_model/5-new-12w-0/', model_num=1, model_type='dnatextcnn', n_gpu=1, n_process=8, no_cuda=False, num_rnn_layer=2, num_train_epochs=5.0, output_dir='/data3/linming/DNABERT/examples/output/100_2506+10020_5_dnatextcnn/', output_mode='classification', overwrite_cache=False, overwrite_output_dir=True, per_gpu_eval_batch_size=32, per_gpu_pred_batch_size=8, per_gpu_train_batch_size=32, predict_dir=None, predict_scan_size=1, result_dir=None, rnn='lstm', rnn_dropout=0.0, rnn_hidden=768, save_steps=4000, save_total_limit=None, seed=42, server_ip='', server_port='', should_continue=False, task_name='dnaprom', tokenizer_name='dna5', visualize_data_dir=None, visualize_models=None, visualize_train=False, warmup_percent=0.1, warmup_steps=0, weight_decay=0.01)
2023-10-26 11:36:51,779 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_train_5-new-12w-0_250_dnaprom
2023-10-26 11:36:53,922 - INFO - __main__ -   ***** Running training *****
2023-10-26 11:36:53,922 - INFO - __main__ -     Num examples = 12526
2023-10-26 11:36:53,922 - INFO - __main__ -     Num Epochs = 5
2023-10-26 11:36:53,923 - INFO - __main__ -     Instantaneous batch size per GPU = 32
2023-10-26 11:36:53,923 - INFO - __main__ -     Total train batch size (w. parallel, distributed & accumulation) = 32
2023-10-26 11:36:53,923 - INFO - __main__ -     Gradient Accumulation steps = 1
2023-10-26 11:36:53,923 - INFO - __main__ -     Total optimization steps = 1960
2023-10-26 11:36:53,923 - INFO - __main__ -     Continuing training from checkpoint, will skip to saved global_step
2023-10-26 11:36:53,923 - INFO - __main__ -     Continuing training from epoch 0
2023-10-26 11:36:53,923 - INFO - __main__ -     Continuing training from global step 0
2023-10-26 11:36:53,923 - INFO - __main__ -     Will skip the first 0 steps in the first epoch
2023-10-26 11:37:20,118 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 11:37:20,141 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 11:37:20,141 - INFO - __main__ -     Num examples = 151
2023-10-26 11:37:20,141 - INFO - __main__ -     Batch size = 32
2023-10-26 11:37:20,512 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 11:37:20,513 - INFO - __main__ -     acc = 0.7549668874172185
2023-10-26 11:37:20,513 - INFO - __main__ -     auc = 0.7694885361552029
2023-10-26 11:37:20,513 - INFO - __main__ -     f1 = 0.752842291528423
2023-10-26 11:37:20,513 - INFO - __main__ -     mcc = 0.5487770014967247
2023-10-26 11:37:20,513 - INFO - __main__ -     precision = 0.7832706766917293
2023-10-26 11:37:20,513 - INFO - __main__ -     recall = 0.7657848324514991
2023-10-26 11:37:20,513 - INFO - __main__ -   {"eval_acc": 0.7549668874172185, "eval_f1": 0.752842291528423, "eval_mcc": 0.5487770014967247, "eval_auc": 0.7694885361552029, "eval_precision": 0.7832706766917293, "eval_recall": 0.7657848324514991, "learning_rate": 5.102040816326531e-05, "loss": 0.5971871674060821, "step": 100}
2023-10-26 11:37:46,806 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 11:37:46,829 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 11:37:46,829 - INFO - __main__ -     Num examples = 151
2023-10-26 11:37:46,829 - INFO - __main__ -     Batch size = 32
2023-10-26 11:37:47,204 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 11:37:47,204 - INFO - __main__ -     acc = 0.7549668874172185
2023-10-26 11:37:47,204 - INFO - __main__ -     auc = 0.7984126984126985
2023-10-26 11:37:47,204 - INFO - __main__ -     f1 = 0.7549238934947582
2023-10-26 11:37:47,204 - INFO - __main__ -     mcc = 0.521125646843239
2023-10-26 11:37:47,204 - INFO - __main__ -     precision = 0.7611622962437987
2023-10-26 11:37:47,204 - INFO - __main__ -     recall = 0.7599647266313934
2023-10-26 11:37:47,205 - INFO - __main__ -   {"eval_acc": 0.7549668874172185, "eval_f1": 0.7549238934947582, "eval_mcc": 0.521125646843239, "eval_auc": 0.7984126984126985, "eval_precision": 0.7611622962437987, "eval_recall": 0.7599647266313934, "learning_rate": 9.977324263038549e-05, "loss": 0.4645676480233669, "step": 200}
2023-10-26 11:38:13,332 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 11:38:13,355 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 11:38:13,355 - INFO - __main__ -     Num examples = 151
2023-10-26 11:38:13,355 - INFO - __main__ -     Batch size = 32
2023-10-26 11:38:13,732 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 11:38:13,732 - INFO - __main__ -     acc = 0.7682119205298014
2023-10-26 11:38:13,732 - INFO - __main__ -     auc = 0.7987654320987654
2023-10-26 11:38:13,732 - INFO - __main__ -     f1 = 0.7675594845406166
2023-10-26 11:38:13,732 - INFO - __main__ -     mcc = 0.5599372704175636
2023-10-26 11:38:13,732 - INFO - __main__ -     precision = 0.783798477709315
2023-10-26 11:38:13,732 - INFO - __main__ -     recall = 0.7761904761904761
2023-10-26 11:38:13,733 - INFO - __main__ -   {"eval_acc": 0.7682119205298014, "eval_f1": 0.7675594845406166, "eval_mcc": 0.5599372704175636, "eval_auc": 0.7987654320987654, "eval_precision": 0.783798477709315, "eval_recall": 0.7761904761904761, "learning_rate": 9.410430839002267e-05, "loss": 0.4211598142981529, "step": 300}
2023-10-26 11:38:39,638 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 11:38:39,661 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 11:38:39,662 - INFO - __main__ -     Num examples = 151
2023-10-26 11:38:39,662 - INFO - __main__ -     Batch size = 32
2023-10-26 11:38:40,038 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 11:38:40,039 - INFO - __main__ -     acc = 0.7748344370860927
2023-10-26 11:38:40,039 - INFO - __main__ -     auc = 0.7922398589065256
2023-10-26 11:38:40,039 - INFO - __main__ -     f1 = 0.7731530576175326
2023-10-26 11:38:40,039 - INFO - __main__ -     mcc = 0.586923367853286
2023-10-26 11:38:40,039 - INFO - __main__ -     precision = 0.8018850317282569
2023-10-26 11:38:40,039 - INFO - __main__ -     recall = 0.7852733686067019
2023-10-26 11:38:40,039 - INFO - __main__ -   {"eval_acc": 0.7748344370860927, "eval_f1": 0.7731530576175326, "eval_mcc": 0.586923367853286, "eval_auc": 0.7922398589065256, "eval_precision": 0.8018850317282569, "eval_recall": 0.7852733686067019, "learning_rate": 8.843537414965987e-05, "loss": 0.3858131191134453, "step": 400}
2023-10-26 11:39:06,006 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 11:39:06,029 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 11:39:06,029 - INFO - __main__ -     Num examples = 151
2023-10-26 11:39:06,029 - INFO - __main__ -     Batch size = 32
2023-10-26 11:39:06,405 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 11:39:06,406 - INFO - __main__ -     acc = 0.7814569536423841
2023-10-26 11:39:06,406 - INFO - __main__ -     auc = 0.8141093474426808
2023-10-26 11:39:06,406 - INFO - __main__ -     f1 = 0.7800679701637463
2023-10-26 11:39:06,406 - INFO - __main__ -     mcc = 0.5976190919747415
2023-10-26 11:39:06,406 - INFO - __main__ -     precision = 0.8063589173155359
2023-10-26 11:39:06,406 - INFO - __main__ -     recall = 0.7914462081128748
2023-10-26 11:39:06,406 - INFO - __main__ -   {"eval_acc": 0.7814569536423841, "eval_f1": 0.7800679701637463, "eval_mcc": 0.5976190919747415, "eval_auc": 0.8141093474426808, "eval_precision": 0.8063589173155359, "eval_recall": 0.7914462081128748, "learning_rate": 8.276643990929706e-05, "loss": 0.35233276039361955, "step": 500}
2023-10-26 11:39:32,356 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 11:39:32,379 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 11:39:32,379 - INFO - __main__ -     Num examples = 151
2023-10-26 11:39:32,379 - INFO - __main__ -     Batch size = 32
2023-10-26 11:39:32,757 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 11:39:32,757 - INFO - __main__ -     acc = 0.7880794701986755
2023-10-26 11:39:32,757 - INFO - __main__ -     auc = 0.8012345679012345
2023-10-26 11:39:32,757 - INFO - __main__ -     f1 = 0.7876230661040788
2023-10-26 11:39:32,757 - INFO - __main__ -     mcc = 0.5980402483701722
2023-10-26 11:39:32,757 - INFO - __main__ -     precision = 0.8023989898989898
2023-10-26 11:39:32,757 - INFO - __main__ -     recall = 0.795679012345679
2023-10-26 11:39:32,758 - INFO - __main__ -   {"eval_acc": 0.7880794701986755, "eval_f1": 0.7876230661040788, "eval_mcc": 0.5980402483701722, "eval_auc": 0.8012345679012345, "eval_precision": 0.8023989898989898, "eval_recall": 0.795679012345679, "learning_rate": 7.709750566893424e-05, "loss": 0.36456787064671514, "step": 600}
2023-10-26 11:39:58,514 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 11:39:58,537 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 11:39:58,537 - INFO - __main__ -     Num examples = 151
2023-10-26 11:39:58,537 - INFO - __main__ -     Batch size = 32
2023-10-26 11:39:58,915 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 11:39:58,915 - INFO - __main__ -     acc = 0.7549668874172185
2023-10-26 11:39:58,915 - INFO - __main__ -     auc = 0.7950617283950616
2023-10-26 11:39:58,915 - INFO - __main__ -     f1 = 0.752842291528423
2023-10-26 11:39:58,915 - INFO - __main__ -     mcc = 0.5487770014967247
2023-10-26 11:39:58,915 - INFO - __main__ -     precision = 0.7832706766917293
2023-10-26 11:39:58,915 - INFO - __main__ -     recall = 0.7657848324514991
2023-10-26 11:39:58,915 - INFO - __main__ -   {"eval_acc": 0.7549668874172185, "eval_f1": 0.752842291528423, "eval_mcc": 0.5487770014967247, "eval_auc": 0.7950617283950616, "eval_precision": 0.7832706766917293, "eval_recall": 0.7657848324514991, "learning_rate": 7.142857142857143e-05, "loss": 0.3170694129914045, "step": 700}
2023-10-26 11:40:24,726 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 11:40:24,749 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 11:40:24,749 - INFO - __main__ -     Num examples = 151
2023-10-26 11:40:24,749 - INFO - __main__ -     Batch size = 32
2023-10-26 11:40:25,126 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 11:40:25,126 - INFO - __main__ -     acc = 0.7880794701986755
2023-10-26 11:40:25,126 - INFO - __main__ -     auc = 0.7968253968253969
2023-10-26 11:40:25,126 - INFO - __main__ -     f1 = 0.7880701754385966
2023-10-26 11:40:25,126 - INFO - __main__ -     mcc = 0.5861585209732402
2023-10-26 11:40:25,126 - INFO - __main__ -     precision = 0.7933898904206433
2023-10-26 11:40:25,126 - INFO - __main__ -     recall = 0.7927689594356261
2023-10-26 11:40:25,127 - INFO - __main__ -   {"eval_acc": 0.7880794701986755, "eval_f1": 0.7880701754385966, "eval_mcc": 0.5861585209732402, "eval_auc": 0.7968253968253969, "eval_precision": 0.7933898904206433, "eval_recall": 0.7927689594356261, "learning_rate": 6.575963718820863e-05, "loss": 0.33067120127379895, "step": 800}
2023-10-26 11:40:51,026 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 11:40:51,049 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 11:40:51,049 - INFO - __main__ -     Num examples = 151
2023-10-26 11:40:51,049 - INFO - __main__ -     Batch size = 32
2023-10-26 11:40:51,426 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 11:40:51,426 - INFO - __main__ -     acc = 0.7814569536423841
2023-10-26 11:40:51,426 - INFO - __main__ -     auc = 0.818694885361552
2023-10-26 11:40:51,426 - INFO - __main__ -     f1 = 0.7813034891375905
2023-10-26 11:40:51,426 - INFO - __main__ -     mcc = 0.5659763825172927
2023-10-26 11:40:51,426 - INFO - __main__ -     precision = 0.7822920322920324
2023-10-26 11:40:51,426 - INFO - __main__ -     recall = 0.7836860670194004
2023-10-26 11:40:51,427 - INFO - __main__ -   {"eval_acc": 0.7814569536423841, "eval_f1": 0.7813034891375905, "eval_mcc": 0.5659763825172927, "eval_auc": 0.818694885361552, "eval_precision": 0.7822920322920324, "eval_recall": 0.7836860670194004, "learning_rate": 6.009070294784581e-05, "loss": 0.281409123763442, "step": 900}
2023-10-26 11:41:17,395 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 11:41:17,417 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 11:41:17,417 - INFO - __main__ -     Num examples = 151
2023-10-26 11:41:17,418 - INFO - __main__ -     Batch size = 32
2023-10-26 11:41:17,794 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 11:41:17,794 - INFO - __main__ -     acc = 0.7947019867549668
2023-10-26 11:41:17,794 - INFO - __main__ -     auc = 0.8107583774250442
2023-10-26 11:41:17,794 - INFO - __main__ -     f1 = 0.794701986754967
2023-10-26 11:41:17,794 - INFO - __main__ -     mcc = 0.5978835978835979
2023-10-26 11:41:17,794 - INFO - __main__ -     precision = 0.7989417989417988
2023-10-26 11:41:17,794 - INFO - __main__ -     recall = 0.7989417989417988
2023-10-26 11:41:17,794 - INFO - __main__ -   {"eval_acc": 0.7947019867549668, "eval_f1": 0.794701986754967, "eval_mcc": 0.5978835978835979, "eval_auc": 0.8107583774250442, "eval_precision": 0.7989417989417988, "eval_recall": 0.7989417989417988, "learning_rate": 5.4421768707483e-05, "loss": 0.28821890547871587, "step": 1000}
2023-10-26 11:41:43,780 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 11:41:43,803 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 11:41:43,803 - INFO - __main__ -     Num examples = 151
2023-10-26 11:41:43,803 - INFO - __main__ -     Batch size = 32
2023-10-26 11:41:44,180 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 11:41:44,181 - INFO - __main__ -     acc = 0.7814569536423841
2023-10-26 11:41:44,181 - INFO - __main__ -     auc = 0.7878306878306879
2023-10-26 11:41:44,181 - INFO - __main__ -     f1 = 0.7811113551504503
2023-10-26 11:41:44,181 - INFO - __main__ -     mcc = 0.5823340064358189
2023-10-26 11:41:44,181 - INFO - __main__ -     precision = 0.7938218390804598
2023-10-26 11:41:44,181 - INFO - __main__ -     recall = 0.7885361552028218
2023-10-26 11:41:44,181 - INFO - __main__ -   {"eval_acc": 0.7814569536423841, "eval_f1": 0.7811113551504503, "eval_mcc": 0.5823340064358189, "eval_auc": 0.7878306878306879, "eval_precision": 0.7938218390804598, "eval_recall": 0.7885361552028218, "learning_rate": 4.875283446712018e-05, "loss": 0.28528155252337456, "step": 1100}
2023-10-26 11:42:10,051 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 11:42:10,075 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 11:42:10,075 - INFO - __main__ -     Num examples = 151
2023-10-26 11:42:10,075 - INFO - __main__ -     Batch size = 32
2023-10-26 11:42:10,453 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 11:42:10,453 - INFO - __main__ -     acc = 0.7880794701986755
2023-10-26 11:42:10,453 - INFO - __main__ -     auc = 0.8298059964726631
2023-10-26 11:42:10,453 - INFO - __main__ -     f1 = 0.7878468563400072
2023-10-26 11:42:10,453 - INFO - __main__ -     mcc = 0.5781902272258623
2023-10-26 11:42:10,453 - INFO - __main__ -     precision = 0.7883333333333333
2023-10-26 11:42:10,453 - INFO - __main__ -     recall = 0.7898589065255732
2023-10-26 11:42:10,454 - INFO - __main__ -   {"eval_acc": 0.7880794701986755, "eval_f1": 0.7878468563400072, "eval_mcc": 0.5781902272258623, "eval_auc": 0.8298059964726631, "eval_precision": 0.7883333333333333, "eval_recall": 0.7898589065255732, "learning_rate": 4.308390022675737e-05, "loss": 0.2502531415224075, "step": 1200}
2023-10-26 11:42:36,443 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 11:42:36,466 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 11:42:36,466 - INFO - __main__ -     Num examples = 151
2023-10-26 11:42:36,466 - INFO - __main__ -     Batch size = 32
2023-10-26 11:42:36,844 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 11:42:36,844 - INFO - __main__ -     acc = 0.7682119205298014
2023-10-26 11:42:36,844 - INFO - __main__ -     auc = 0.8178130511463845
2023-10-26 11:42:36,844 - INFO - __main__ -     f1 = 0.7680491551459293
2023-10-26 11:42:36,844 - INFO - __main__ -     mcc = 0.5514262406180365
2023-10-26 11:42:36,844 - INFO - __main__ -     precision = 0.7771836007130125
2023-10-26 11:42:36,844 - INFO - __main__ -     recall = 0.7742504409171076
2023-10-26 11:42:36,844 - INFO - __main__ -   {"eval_acc": 0.7682119205298014, "eval_f1": 0.7680491551459293, "eval_mcc": 0.5514262406180365, "eval_auc": 0.8178130511463845, "eval_precision": 0.7771836007130125, "eval_recall": 0.7742504409171076, "learning_rate": 3.7414965986394564e-05, "loss": 0.20297135636210442, "step": 1300}
2023-10-26 11:43:02,783 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 11:43:02,805 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 11:43:02,805 - INFO - __main__ -     Num examples = 151
2023-10-26 11:43:02,805 - INFO - __main__ -     Batch size = 32
2023-10-26 11:43:03,182 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 11:43:03,182 - INFO - __main__ -     acc = 0.7682119205298014
2023-10-26 11:43:03,182 - INFO - __main__ -     auc = 0.807231040564374
2023-10-26 11:43:03,182 - INFO - __main__ -     f1 = 0.7662021676620218
2023-10-26 11:43:03,182 - INFO - __main__ -     mcc = 0.5330183759288142
2023-10-26 11:43:03,182 - INFO - __main__ -     precision = 0.7675017768301351
2023-10-26 11:43:03,182 - INFO - __main__ -     recall = 0.7655202821869489
2023-10-26 11:43:03,182 - INFO - __main__ -   {"eval_acc": 0.7682119205298014, "eval_f1": 0.7662021676620218, "eval_mcc": 0.5330183759288142, "eval_auc": 0.807231040564374, "eval_precision": 0.7675017768301351, "eval_recall": 0.7655202821869489, "learning_rate": 3.1746031746031745e-05, "loss": 0.21270701045170426, "step": 1400}
2023-10-26 11:43:29,116 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 11:43:29,138 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 11:43:29,139 - INFO - __main__ -     Num examples = 151
2023-10-26 11:43:29,139 - INFO - __main__ -     Batch size = 32
2023-10-26 11:43:29,516 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 11:43:29,516 - INFO - __main__ -     acc = 0.7682119205298014
2023-10-26 11:43:29,516 - INFO - __main__ -     auc = 0.8098765432098766
2023-10-26 11:43:29,516 - INFO - __main__ -     f1 = 0.7648707567735906
2023-10-26 11:43:29,516 - INFO - __main__ -     mcc = 0.5331172986514896
2023-10-26 11:43:29,516 - INFO - __main__ -     precision = 0.7695707070707071
2023-10-26 11:43:29,516 - INFO - __main__ -     recall = 0.7635802469135802
2023-10-26 11:43:29,517 - INFO - __main__ -   {"eval_acc": 0.7682119205298014, "eval_f1": 0.7648707567735906, "eval_mcc": 0.5331172986514896, "eval_auc": 0.8098765432098766, "eval_precision": 0.7695707070707071, "eval_recall": 0.7635802469135802, "learning_rate": 2.6077097505668935e-05, "loss": 0.21233408134430648, "step": 1500}
2023-10-26 11:43:55,459 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 11:43:55,482 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 11:43:55,482 - INFO - __main__ -     Num examples = 151
2023-10-26 11:43:55,482 - INFO - __main__ -     Batch size = 32
2023-10-26 11:43:55,860 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 11:43:55,860 - INFO - __main__ -     acc = 0.7549668874172185
2023-10-26 11:43:55,860 - INFO - __main__ -     auc = 0.7920634920634921
2023-10-26 11:43:55,860 - INFO - __main__ -     f1 = 0.7542771693715091
2023-10-26 11:43:55,860 - INFO - __main__ -     mcc = 0.5329415718757207
2023-10-26 11:43:55,860 - INFO - __main__ -     precision = 0.7701159840521928
2023-10-26 11:43:55,860 - INFO - __main__ -     recall = 0.7628747795414462
2023-10-26 11:43:55,861 - INFO - __main__ -   {"eval_acc": 0.7549668874172185, "eval_f1": 0.7542771693715091, "eval_mcc": 0.5329415718757207, "eval_auc": 0.7920634920634921, "eval_precision": 0.7701159840521928, "eval_recall": 0.7628747795414462, "learning_rate": 2.0408163265306123e-05, "loss": 0.19023582026362418, "step": 1600}
2023-10-26 11:44:21,893 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 11:44:21,916 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 11:44:21,916 - INFO - __main__ -     Num examples = 151
2023-10-26 11:44:21,916 - INFO - __main__ -     Batch size = 32
2023-10-26 11:44:22,294 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 11:44:22,295 - INFO - __main__ -     acc = 0.7483443708609272
2023-10-26 11:44:22,295 - INFO - __main__ -     auc = 0.7751322751322751
2023-10-26 11:44:22,295 - INFO - __main__ -     f1 = 0.7483333333333333
2023-10-26 11:44:22,295 - INFO - __main__ -     mcc = 0.5032601072251373
2023-10-26 11:44:22,295 - INFO - __main__ -     precision = 0.7514084507042254
2023-10-26 11:44:22,295 - INFO - __main__ -     recall = 0.7518518518518519
2023-10-26 11:44:22,295 - INFO - __main__ -   {"eval_acc": 0.7483443708609272, "eval_f1": 0.7483333333333333, "eval_mcc": 0.5032601072251373, "eval_auc": 0.7751322751322751, "eval_precision": 0.7514084507042254, "eval_recall": 0.7518518518518519, "learning_rate": 1.473922902494331e-05, "loss": 0.12947433989495039, "step": 1700}
2023-10-26 11:44:48,335 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 11:44:48,358 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 11:44:48,358 - INFO - __main__ -     Num examples = 151
2023-10-26 11:44:48,358 - INFO - __main__ -     Batch size = 32
2023-10-26 11:44:48,736 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 11:44:48,736 - INFO - __main__ -     acc = 0.7483443708609272
2023-10-26 11:44:48,736 - INFO - __main__ -     auc = 0.7793650793650794
2023-10-26 11:44:48,736 - INFO - __main__ -     f1 = 0.7464651820431247
2023-10-26 11:44:48,736 - INFO - __main__ -     mcc = 0.49319557486181714
2023-10-26 11:44:48,736 - INFO - __main__ -     precision = 0.7471651311126861
2023-10-26 11:44:48,736 - INFO - __main__ -     recall = 0.746031746031746
2023-10-26 11:44:48,737 - INFO - __main__ -   {"eval_acc": 0.7483443708609272, "eval_f1": 0.7464651820431247, "eval_mcc": 0.49319557486181714, "eval_auc": 0.7793650793650794, "eval_precision": 0.7471651311126861, "eval_recall": 0.746031746031746, "learning_rate": 9.070294784580499e-06, "loss": 0.12999152301810682, "step": 1800}
2023-10-26 11:45:14,696 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 11:45:14,720 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 11:45:14,720 - INFO - __main__ -     Num examples = 151
2023-10-26 11:45:14,720 - INFO - __main__ -     Batch size = 32
2023-10-26 11:45:15,098 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 11:45:15,098 - INFO - __main__ -     acc = 0.7483443708609272
2023-10-26 11:45:15,098 - INFO - __main__ -     auc = 0.7807760141093476
2023-10-26 11:45:15,098 - INFO - __main__ -     f1 = 0.7482449982449983
2023-10-26 11:45:15,098 - INFO - __main__ -     mcc = 0.5007050941110518
2023-10-26 11:45:15,098 - INFO - __main__ -     precision = 0.7498243765367053
2023-10-26 11:45:15,098 - INFO - __main__ -     recall = 0.7508818342151675
2023-10-26 11:45:15,098 - INFO - __main__ -   {"eval_acc": 0.7483443708609272, "eval_f1": 0.7482449982449983, "eval_mcc": 0.5007050941110518, "eval_auc": 0.7807760141093476, "eval_precision": 0.7498243765367053, "eval_recall": 0.7508818342151675, "learning_rate": 3.4013605442176877e-06, "loss": 0.14128227975219487, "step": 1900}
2023-10-26 11:45:30,705 - INFO - __main__ -    global_step = 1960, average loss = 0.28804490448127745
2023-10-26 11:45:30,706 - INFO - __main__ -   Saving model checkpoint to /data3/linming/DNABERT/examples/output/100_2506+10020_5_dnatextcnn/
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         2023-10-26 14:53:25,599 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
2023-10-26 14:53:30,292 - INFO - __main__ -   finish loading model
2023-10-26 14:53:42,171 - INFO - __main__ -   Training/evaluation parameters Namespace(adam_epsilon=1e-08, attention_probs_dropout_prob=0.1, beta1=0.9, beta2=0.999, cache_dir='', config_name='', data_dir='/data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after', device=device(type='cuda'), do_ensemble_pred=False, do_eval=True, do_lower_case=False, do_predict=False, do_train=True, do_visualize=False, early_stop=0, eval_all_checkpoints=False, evaluate_during_training=True, filter_num=128, filter_size=[2, 3, 4, 5, 6], fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, hidden_dropout_prob=0.1, learning_rate=0.0001, local_rank=-1, logging_steps=100, max_grad_norm=1.0, max_seq_length=250, max_steps=-1, model_name='mutant_Bert_100_2506+10020_5_dnatextcnn', model_name_or_path='/data3/linming/DNABERT/examples/embeding_model/5-new-12w-0/', model_num=1, model_type='dnatextcnn', n_gpu=1, n_process=8, no_cuda=False, num_rnn_layer=2, num_train_epochs=5.0, output_dir='/data3/linming/DNABERT/examples/output/100_2506+10020_5_dnatextcnn/', output_mode='classification', overwrite_cache=False, overwrite_output_dir=True, per_gpu_eval_batch_size=32, per_gpu_pred_batch_size=8, per_gpu_train_batch_size=32, predict_dir=None, predict_scan_size=1, result_dir=None, rnn='lstm', rnn_dropout=0.0, rnn_hidden=768, save_steps=4000, save_total_limit=None, seed=42, server_ip='', server_port='', should_continue=False, task_name='dnaprom', tokenizer_name='dna5', visualize_data_dir=None, visualize_models=None, visualize_train=False, warmup_percent=0.1, warmup_steps=0, weight_decay=0.01)
2023-10-26 14:53:42,191 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_train_5-new-12w-0_250_dnaprom
2023-10-26 14:53:44,469 - INFO - __main__ -   ***** Running training *****
2023-10-26 14:53:44,469 - INFO - __main__ -     Num examples = 12526
2023-10-26 14:53:44,469 - INFO - __main__ -     Num Epochs = 5
2023-10-26 14:53:44,470 - INFO - __main__ -     Instantaneous batch size per GPU = 32
2023-10-26 14:53:44,470 - INFO - __main__ -     Total train batch size (w. parallel, distributed & accumulation) = 32
2023-10-26 14:53:44,470 - INFO - __main__ -     Gradient Accumulation steps = 1
2023-10-26 14:53:44,470 - INFO - __main__ -     Total optimization steps = 1960
2023-10-26 14:53:44,470 - INFO - __main__ -     Continuing training from checkpoint, will skip to saved global_step
2023-10-26 14:53:44,470 - INFO - __main__ -     Continuing training from epoch 0
2023-10-26 14:53:44,470 - INFO - __main__ -     Continuing training from global step 0
2023-10-26 14:53:44,470 - INFO - __main__ -     Will skip the first 0 steps in the first epoch
2023-10-26 14:54:13,583 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 14:54:13,626 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 14:54:13,626 - INFO - __main__ -     Num examples = 151
2023-10-26 14:54:13,626 - INFO - __main__ -     Batch size = 32
2023-10-26 14:54:14,080 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 14:54:14,081 - INFO - __main__ -     acc = 0.7549668874172185
2023-10-26 14:54:14,081 - INFO - __main__ -     auc = 0.7694885361552029
2023-10-26 14:54:14,081 - INFO - __main__ -     f1 = 0.752842291528423
2023-10-26 14:54:14,081 - INFO - __main__ -     mcc = 0.5487770014967247
2023-10-26 14:54:14,081 - INFO - __main__ -     precision = 0.7832706766917293
2023-10-26 14:54:14,081 - INFO - __main__ -     recall = 0.7657848324514991
2023-10-26 14:54:14,086 - INFO - __main__ -   {"eval_acc": 0.7549668874172185, "eval_f1": 0.752842291528423, "eval_mcc": 0.5487770014967247, "eval_auc": 0.7694885361552029, "eval_precision": 0.7832706766917293, "eval_recall": 0.7657848324514991, "learning_rate": 5.102040816326531e-05, "loss": 0.5971871674060821, "step": 100}
2023-10-26 14:54:40,742 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 14:54:40,765 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 14:54:40,765 - INFO - __main__ -     Num examples = 151
2023-10-26 14:54:40,765 - INFO - __main__ -     Batch size = 32
2023-10-26 14:54:41,139 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 14:54:41,140 - INFO - __main__ -     acc = 0.7549668874172185
2023-10-26 14:54:41,140 - INFO - __main__ -     auc = 0.7984126984126985
2023-10-26 14:54:41,140 - INFO - __main__ -     f1 = 0.7549238934947582
2023-10-26 14:54:41,140 - INFO - __main__ -     mcc = 0.521125646843239
2023-10-26 14:54:41,140 - INFO - __main__ -     precision = 0.7611622962437987
2023-10-26 14:54:41,140 - INFO - __main__ -     recall = 0.7599647266313934
2023-10-26 14:54:41,140 - INFO - __main__ -   {"eval_acc": 0.7549668874172185, "eval_f1": 0.7549238934947582, "eval_mcc": 0.521125646843239, "eval_auc": 0.7984126984126985, "eval_precision": 0.7611622962437987, "eval_recall": 0.7599647266313934, "learning_rate": 9.977324263038549e-05, "loss": 0.4645676480233669, "step": 200}
2023-10-26 14:55:07,041 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 14:55:07,063 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 14:55:07,063 - INFO - __main__ -     Num examples = 151
2023-10-26 14:55:07,063 - INFO - __main__ -     Batch size = 32
2023-10-26 14:55:07,439 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 14:55:07,439 - INFO - __main__ -     acc = 0.7682119205298014
2023-10-26 14:55:07,439 - INFO - __main__ -     auc = 0.7987654320987654
2023-10-26 14:55:07,439 - INFO - __main__ -     f1 = 0.7675594845406166
2023-10-26 14:55:07,439 - INFO - __main__ -     mcc = 0.5599372704175636
2023-10-26 14:55:07,439 - INFO - __main__ -     precision = 0.783798477709315
2023-10-26 14:55:07,439 - INFO - __main__ -     recall = 0.7761904761904761
2023-10-26 14:55:07,440 - INFO - __main__ -   {"eval_acc": 0.7682119205298014, "eval_f1": 0.7675594845406166, "eval_mcc": 0.5599372704175636, "eval_auc": 0.7987654320987654, "eval_precision": 0.783798477709315, "eval_recall": 0.7761904761904761, "learning_rate": 9.410430839002267e-05, "loss": 0.4211598142981529, "step": 300}
2023-10-26 14:55:32,956 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 14:55:32,978 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 14:55:32,978 - INFO - __main__ -     Num examples = 151
2023-10-26 14:55:32,978 - INFO - __main__ -     Batch size = 32
2023-10-26 14:55:33,354 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 14:55:33,354 - INFO - __main__ -     acc = 0.7748344370860927
2023-10-26 14:55:33,354 - INFO - __main__ -     auc = 0.7922398589065256
2023-10-26 14:55:33,354 - INFO - __main__ -     f1 = 0.7731530576175326
2023-10-26 14:55:33,354 - INFO - __main__ -     mcc = 0.586923367853286
2023-10-26 14:55:33,354 - INFO - __main__ -     precision = 0.8018850317282569
2023-10-26 14:55:33,354 - INFO - __main__ -     recall = 0.7852733686067019
2023-10-26 14:55:33,354 - INFO - __main__ -   {"eval_acc": 0.7748344370860927, "eval_f1": 0.7731530576175326, "eval_mcc": 0.586923367853286, "eval_auc": 0.7922398589065256, "eval_precision": 0.8018850317282569, "eval_recall": 0.7852733686067019, "learning_rate": 8.843537414965987e-05, "loss": 0.3858131191134453, "step": 400}
2023-10-26 14:55:58,951 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 14:55:58,973 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 14:55:58,973 - INFO - __main__ -     Num examples = 151
2023-10-26 14:55:58,973 - INFO - __main__ -     Batch size = 32
2023-10-26 14:55:59,349 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 14:55:59,349 - INFO - __main__ -     acc = 0.7814569536423841
2023-10-26 14:55:59,349 - INFO - __main__ -     auc = 0.8141093474426808
2023-10-26 14:55:59,349 - INFO - __main__ -     f1 = 0.7800679701637463
2023-10-26 14:55:59,350 - INFO - __main__ -     mcc = 0.5976190919747415
2023-10-26 14:55:59,350 - INFO - __main__ -     precision = 0.8063589173155359
2023-10-26 14:55:59,350 - INFO - __main__ -     recall = 0.7914462081128748
2023-10-26 14:55:59,350 - INFO - __main__ -   {"eval_acc": 0.7814569536423841, "eval_f1": 0.7800679701637463, "eval_mcc": 0.5976190919747415, "eval_auc": 0.8141093474426808, "eval_precision": 0.8063589173155359, "eval_recall": 0.7914462081128748, "learning_rate": 8.276643990929706e-05, "loss": 0.35233276039361955, "step": 500}
2023-10-26 14:56:25,004 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 14:56:25,026 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 14:56:25,026 - INFO - __main__ -     Num examples = 151
2023-10-26 14:56:25,026 - INFO - __main__ -     Batch size = 32
2023-10-26 14:56:25,404 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 14:56:25,404 - INFO - __main__ -     acc = 0.7880794701986755
2023-10-26 14:56:25,404 - INFO - __main__ -     auc = 0.8012345679012345
2023-10-26 14:56:25,404 - INFO - __main__ -     f1 = 0.7876230661040788
2023-10-26 14:56:25,404 - INFO - __main__ -     mcc = 0.5980402483701722
2023-10-26 14:56:25,404 - INFO - __main__ -     precision = 0.8023989898989898
2023-10-26 14:56:25,404 - INFO - __main__ -     recall = 0.795679012345679
2023-10-26 14:56:25,405 - INFO - __main__ -   {"eval_acc": 0.7880794701986755, "eval_f1": 0.7876230661040788, "eval_mcc": 0.5980402483701722, "eval_auc": 0.8012345679012345, "eval_precision": 0.8023989898989898, "eval_recall": 0.795679012345679, "learning_rate": 7.709750566893424e-05, "loss": 0.36456787064671514, "step": 600}
2023-10-26 14:56:51,045 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 14:56:51,067 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 14:56:51,067 - INFO - __main__ -     Num examples = 151
2023-10-26 14:56:51,067 - INFO - __main__ -     Batch size = 32
2023-10-26 14:56:51,445 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 14:56:51,446 - INFO - __main__ -     acc = 0.7549668874172185
2023-10-26 14:56:51,446 - INFO - __main__ -     auc = 0.7950617283950616
2023-10-26 14:56:51,446 - INFO - __main__ -     f1 = 0.752842291528423
2023-10-26 14:56:51,446 - INFO - __main__ -     mcc = 0.5487770014967247
2023-10-26 14:56:51,446 - INFO - __main__ -     precision = 0.7832706766917293
2023-10-26 14:56:51,446 - INFO - __main__ -     recall = 0.7657848324514991
2023-10-26 14:56:51,446 - INFO - __main__ -   {"eval_acc": 0.7549668874172185, "eval_f1": 0.752842291528423, "eval_mcc": 0.5487770014967247, "eval_auc": 0.7950617283950616, "eval_precision": 0.7832706766917293, "eval_recall": 0.7657848324514991, "learning_rate": 7.142857142857143e-05, "loss": 0.3170694129914045, "step": 700}
2023-10-26 14:57:17,440 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 14:57:17,462 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 14:57:17,462 - INFO - __main__ -     Num examples = 151
2023-10-26 14:57:17,462 - INFO - __main__ -     Batch size = 32
2023-10-26 14:57:17,845 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 14:57:17,845 - INFO - __main__ -     acc = 0.7880794701986755
2023-10-26 14:57:17,845 - INFO - __main__ -     auc = 0.7968253968253969
2023-10-26 14:57:17,845 - INFO - __main__ -     f1 = 0.7880701754385966
2023-10-26 14:57:17,845 - INFO - __main__ -     mcc = 0.5861585209732402
2023-10-26 14:57:17,845 - INFO - __main__ -     precision = 0.7933898904206433
2023-10-26 14:57:17,845 - INFO - __main__ -     recall = 0.7927689594356261
2023-10-26 14:57:17,846 - INFO - __main__ -   {"eval_acc": 0.7880794701986755, "eval_f1": 0.7880701754385966, "eval_mcc": 0.5861585209732402, "eval_auc": 0.7968253968253969, "eval_precision": 0.7933898904206433, "eval_recall": 0.7927689594356261, "learning_rate": 6.575963718820863e-05, "loss": 0.33067120127379895, "step": 800}
2023-10-26 14:57:43,675 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 14:57:43,696 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 14:57:43,696 - INFO - __main__ -     Num examples = 151
2023-10-26 14:57:43,696 - INFO - __main__ -     Batch size = 32
2023-10-26 14:57:44,076 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 14:57:44,076 - INFO - __main__ -     acc = 0.7814569536423841
2023-10-26 14:57:44,076 - INFO - __main__ -     auc = 0.818694885361552
2023-10-26 14:57:44,076 - INFO - __main__ -     f1 = 0.7813034891375905
2023-10-26 14:57:44,076 - INFO - __main__ -     mcc = 0.5659763825172927
2023-10-26 14:57:44,077 - INFO - __main__ -     precision = 0.7822920322920324
2023-10-26 14:57:44,077 - INFO - __main__ -     recall = 0.7836860670194004
2023-10-26 14:57:44,077 - INFO - __main__ -   {"eval_acc": 0.7814569536423841, "eval_f1": 0.7813034891375905, "eval_mcc": 0.5659763825172927, "eval_auc": 0.818694885361552, "eval_precision": 0.7822920322920324, "eval_recall": 0.7836860670194004, "learning_rate": 6.009070294784581e-05, "loss": 0.281409123763442, "step": 900}
2023-10-26 14:58:09,953 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 14:58:09,975 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 14:58:09,975 - INFO - __main__ -     Num examples = 151
2023-10-26 14:58:09,975 - INFO - __main__ -     Batch size = 32
2023-10-26 14:58:10,353 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 14:58:10,353 - INFO - __main__ -     acc = 0.7947019867549668
2023-10-26 14:58:10,353 - INFO - __main__ -     auc = 0.8107583774250442
2023-10-26 14:58:10,353 - INFO - __main__ -     f1 = 0.794701986754967
2023-10-26 14:58:10,353 - INFO - __main__ -     mcc = 0.5978835978835979
2023-10-26 14:58:10,354 - INFO - __main__ -     precision = 0.7989417989417988
2023-10-26 14:58:10,354 - INFO - __main__ -     recall = 0.7989417989417988
2023-10-26 14:58:10,354 - INFO - __main__ -   {"eval_acc": 0.7947019867549668, "eval_f1": 0.794701986754967, "eval_mcc": 0.5978835978835979, "eval_auc": 0.8107583774250442, "eval_precision": 0.7989417989417988, "eval_recall": 0.7989417989417988, "learning_rate": 5.4421768707483e-05, "loss": 0.28821890547871587, "step": 1000}
2023-10-26 14:58:36,215 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 14:58:36,237 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 14:58:36,237 - INFO - __main__ -     Num examples = 151
2023-10-26 14:58:36,237 - INFO - __main__ -     Batch size = 32
2023-10-26 14:58:36,615 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 14:58:36,616 - INFO - __main__ -     acc = 0.7814569536423841
2023-10-26 14:58:36,616 - INFO - __main__ -     auc = 0.7878306878306879
2023-10-26 14:58:36,616 - INFO - __main__ -     f1 = 0.7811113551504503
2023-10-26 14:58:36,616 - INFO - __main__ -     mcc = 0.5823340064358189
2023-10-26 14:58:36,616 - INFO - __main__ -     precision = 0.7938218390804598
2023-10-26 14:58:36,616 - INFO - __main__ -     recall = 0.7885361552028218
2023-10-26 14:58:36,616 - INFO - __main__ -   {"eval_acc": 0.7814569536423841, "eval_f1": 0.7811113551504503, "eval_mcc": 0.5823340064358189, "eval_auc": 0.7878306878306879, "eval_precision": 0.7938218390804598, "eval_recall": 0.7885361552028218, "learning_rate": 4.875283446712018e-05, "loss": 0.28528155252337456, "step": 1100}
2023-10-26 14:59:02,334 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 14:59:02,357 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 14:59:02,357 - INFO - __main__ -     Num examples = 151
2023-10-26 14:59:02,358 - INFO - __main__ -     Batch size = 32
2023-10-26 14:59:02,736 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 14:59:02,736 - INFO - __main__ -     acc = 0.7880794701986755
2023-10-26 14:59:02,736 - INFO - __main__ -     auc = 0.8298059964726631
2023-10-26 14:59:02,736 - INFO - __main__ -     f1 = 0.7878468563400072
2023-10-26 14:59:02,736 - INFO - __main__ -     mcc = 0.5781902272258623
2023-10-26 14:59:02,736 - INFO - __main__ -     precision = 0.7883333333333333
2023-10-26 14:59:02,736 - INFO - __main__ -     recall = 0.7898589065255732
2023-10-26 14:59:02,737 - INFO - __main__ -   {"eval_acc": 0.7880794701986755, "eval_f1": 0.7878468563400072, "eval_mcc": 0.5781902272258623, "eval_auc": 0.8298059964726631, "eval_precision": 0.7883333333333333, "eval_recall": 0.7898589065255732, "learning_rate": 4.308390022675737e-05, "loss": 0.2502531415224075, "step": 1200}
2023-10-26 14:59:28,587 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 14:59:28,609 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 14:59:28,610 - INFO - __main__ -     Num examples = 151
2023-10-26 14:59:28,610 - INFO - __main__ -     Batch size = 32
2023-10-26 14:59:28,988 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 14:59:28,988 - INFO - __main__ -     acc = 0.7682119205298014
2023-10-26 14:59:28,988 - INFO - __main__ -     auc = 0.8178130511463845
2023-10-26 14:59:28,988 - INFO - __main__ -     f1 = 0.7680491551459293
2023-10-26 14:59:28,988 - INFO - __main__ -     mcc = 0.5514262406180365
2023-10-26 14:59:28,988 - INFO - __main__ -     precision = 0.7771836007130125
2023-10-26 14:59:28,988 - INFO - __main__ -     recall = 0.7742504409171076
2023-10-26 14:59:28,989 - INFO - __main__ -   {"eval_acc": 0.7682119205298014, "eval_f1": 0.7680491551459293, "eval_mcc": 0.5514262406180365, "eval_auc": 0.8178130511463845, "eval_precision": 0.7771836007130125, "eval_recall": 0.7742504409171076, "learning_rate": 3.7414965986394564e-05, "loss": 0.20297135636210442, "step": 1300}
2023-10-26 14:59:54,792 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 14:59:54,814 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 14:59:54,814 - INFO - __main__ -     Num examples = 151
2023-10-26 14:59:54,814 - INFO - __main__ -     Batch size = 32
2023-10-26 14:59:55,192 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 14:59:55,192 - INFO - __main__ -     acc = 0.7682119205298014
2023-10-26 14:59:55,192 - INFO - __main__ -     auc = 0.807231040564374
2023-10-26 14:59:55,192 - INFO - __main__ -     f1 = 0.7662021676620218
2023-10-26 14:59:55,193 - INFO - __main__ -     mcc = 0.5330183759288142
2023-10-26 14:59:55,193 - INFO - __main__ -     precision = 0.7675017768301351
2023-10-26 14:59:55,193 - INFO - __main__ -     recall = 0.7655202821869489
2023-10-26 14:59:55,193 - INFO - __main__ -   {"eval_acc": 0.7682119205298014, "eval_f1": 0.7662021676620218, "eval_mcc": 0.5330183759288142, "eval_auc": 0.807231040564374, "eval_precision": 0.7675017768301351, "eval_recall": 0.7655202821869489, "learning_rate": 3.1746031746031745e-05, "loss": 0.21270701045170426, "step": 1400}
2023-10-26 15:00:21,168 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 15:00:21,190 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 15:00:21,190 - INFO - __main__ -     Num examples = 151
2023-10-26 15:00:21,190 - INFO - __main__ -     Batch size = 32
2023-10-26 15:00:21,568 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 15:00:21,568 - INFO - __main__ -     acc = 0.7682119205298014
2023-10-26 15:00:21,568 - INFO - __main__ -     auc = 0.8098765432098766
2023-10-26 15:00:21,568 - INFO - __main__ -     f1 = 0.7648707567735906
2023-10-26 15:00:21,568 - INFO - __main__ -     mcc = 0.5331172986514896
2023-10-26 15:00:21,568 - INFO - __main__ -     precision = 0.7695707070707071
2023-10-26 15:00:21,568 - INFO - __main__ -     recall = 0.7635802469135802
2023-10-26 15:00:21,569 - INFO - __main__ -   {"eval_acc": 0.7682119205298014, "eval_f1": 0.7648707567735906, "eval_mcc": 0.5331172986514896, "eval_auc": 0.8098765432098766, "eval_precision": 0.7695707070707071, "eval_recall": 0.7635802469135802, "learning_rate": 2.6077097505668935e-05, "loss": 0.21233408134430648, "step": 1500}
2023-10-26 15:00:47,283 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 15:00:47,305 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 15:00:47,305 - INFO - __main__ -     Num examples = 151
2023-10-26 15:00:47,305 - INFO - __main__ -     Batch size = 32
2023-10-26 15:00:47,684 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 15:00:47,684 - INFO - __main__ -     acc = 0.7549668874172185
2023-10-26 15:00:47,684 - INFO - __main__ -     auc = 0.7920634920634921
2023-10-26 15:00:47,684 - INFO - __main__ -     f1 = 0.7542771693715091
2023-10-26 15:00:47,684 - INFO - __main__ -     mcc = 0.5329415718757207
2023-10-26 15:00:47,684 - INFO - __main__ -     precision = 0.7701159840521928
2023-10-26 15:00:47,684 - INFO - __main__ -     recall = 0.7628747795414462
2023-10-26 15:00:47,685 - INFO - __main__ -   {"eval_acc": 0.7549668874172185, "eval_f1": 0.7542771693715091, "eval_mcc": 0.5329415718757207, "eval_auc": 0.7920634920634921, "eval_precision": 0.7701159840521928, "eval_recall": 0.7628747795414462, "learning_rate": 2.0408163265306123e-05, "loss": 0.19023582026362418, "step": 1600}
2023-10-26 15:01:13,497 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 15:01:13,519 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 15:01:13,519 - INFO - __main__ -     Num examples = 151
2023-10-26 15:01:13,519 - INFO - __main__ -     Batch size = 32
2023-10-26 15:01:13,897 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 15:01:13,897 - INFO - __main__ -     acc = 0.7483443708609272
2023-10-26 15:01:13,897 - INFO - __main__ -     auc = 0.7751322751322751
2023-10-26 15:01:13,897 - INFO - __main__ -     f1 = 0.7483333333333333
2023-10-26 15:01:13,897 - INFO - __main__ -     mcc = 0.5032601072251373
2023-10-26 15:01:13,897 - INFO - __main__ -     precision = 0.7514084507042254
2023-10-26 15:01:13,897 - INFO - __main__ -     recall = 0.7518518518518519
2023-10-26 15:01:13,898 - INFO - __main__ -   {"eval_acc": 0.7483443708609272, "eval_f1": 0.7483333333333333, "eval_mcc": 0.5032601072251373, "eval_auc": 0.7751322751322751, "eval_precision": 0.7514084507042254, "eval_recall": 0.7518518518518519, "learning_rate": 1.473922902494331e-05, "loss": 0.12947433989495039, "step": 1700}
2023-10-26 15:01:39,704 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 15:01:39,727 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 15:01:39,727 - INFO - __main__ -     Num examples = 151
2023-10-26 15:01:39,727 - INFO - __main__ -     Batch size = 32
2023-10-26 15:01:40,105 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 15:01:40,105 - INFO - __main__ -     acc = 0.7483443708609272
2023-10-26 15:01:40,106 - INFO - __main__ -     auc = 0.7793650793650794
2023-10-26 15:01:40,106 - INFO - __main__ -     f1 = 0.7464651820431247
2023-10-26 15:01:40,106 - INFO - __main__ -     mcc = 0.49319557486181714
2023-10-26 15:01:40,106 - INFO - __main__ -     precision = 0.7471651311126861
2023-10-26 15:01:40,106 - INFO - __main__ -     recall = 0.746031746031746
2023-10-26 15:01:40,106 - INFO - __main__ -   {"eval_acc": 0.7483443708609272, "eval_f1": 0.7464651820431247, "eval_mcc": 0.49319557486181714, "eval_auc": 0.7793650793650794, "eval_precision": 0.7471651311126861, "eval_recall": 0.746031746031746, "learning_rate": 9.070294784580499e-06, "loss": 0.12999152301810682, "step": 1800}
2023-10-26 15:02:05,949 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 15:02:05,971 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 15:02:05,971 - INFO - __main__ -     Num examples = 151
2023-10-26 15:02:05,971 - INFO - __main__ -     Batch size = 32
2023-10-26 15:02:06,349 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 15:02:06,349 - INFO - __main__ -     acc = 0.7483443708609272
2023-10-26 15:02:06,349 - INFO - __main__ -     auc = 0.7807760141093476
2023-10-26 15:02:06,349 - INFO - __main__ -     f1 = 0.7482449982449983
2023-10-26 15:02:06,349 - INFO - __main__ -     mcc = 0.5007050941110518
2023-10-26 15:02:06,349 - INFO - __main__ -     precision = 0.7498243765367053
2023-10-26 15:02:06,350 - INFO - __main__ -     recall = 0.7508818342151675
2023-10-26 15:02:06,350 - INFO - __main__ -   {"eval_acc": 0.7483443708609272, "eval_f1": 0.7482449982449983, "eval_mcc": 0.5007050941110518, "eval_auc": 0.7807760141093476, "eval_precision": 0.7498243765367053, "eval_recall": 0.7508818342151675, "learning_rate": 3.4013605442176877e-06, "loss": 0.14128227975219487, "step": 1900}
2023-10-26 15:02:21,919 - INFO - __main__ -    global_step = 1960, average loss = 0.28804490448127745
2023-10-26 15:02:21,919 - INFO - __main__ -   Saving model checkpoint to /data3/linming/DNABERT/examples/output/100_2506+10020_5_dnatextcnn/
2023-10-26 15:02:27,172 - INFO - __main__ -   Evaluate the following checkpoints: ['/data3/linming/DNABERT/examples/output/100_2506+10020_5_dnatextcnn/']
2023-10-26 15:02:29,390 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_5/fea/after/cached_dev_5-new-12w-0_250_dnaprom
2023-10-26 15:02:29,412 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-26 15:02:29,412 - INFO - __main__ -     Num examples = 151
2023-10-26 15:02:29,412 - INFO - __main__ -     Batch size = 32
2023-10-26 15:02:29,797 - INFO - __main__ -   ***** Eval results  *****
2023-10-26 15:02:29,797 - INFO - __main__ -     acc = 0.7615894039735099
2023-10-26 15:02:29,797 - INFO - __main__ -     auc = 0.7818342151675486
2023-10-26 15:02:29,797 - INFO - __main__ -     f1 = 0.7607394366197182
2023-10-26 15:02:29,797 - INFO - __main__ -     mcc = 0.521747441603037
2023-10-26 15:02:29,797 - INFO - __main__ -     precision = 0.7604606188466948
2023-10-26 15:02:29,797 - INFO - __main__ -     recall = 0.7612874779541445
