2023-10-25 21:45:13,273 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
2023-10-25 21:45:17,990 - INFO - __main__ -   finish loading model
2023-10-25 21:45:30,111 - INFO - __main__ -   Training/evaluation parameters Namespace(adam_epsilon=1e-08, attention_probs_dropout_prob=0.1, beta1=0.9, beta2=0.999, cache_dir='', config_name='', data_dir='/data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/', data_dir_after='/data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/after/', data_dir_before='/data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/before/', device=device(type='cuda'), do_ensemble_pred=False, do_eval=True, do_lower_case=False, do_predict=False, do_train=True, do_visualize=False, early_stop=0, eval_all_checkpoints=False, evaluate_during_training=True, filter_num=128, filter_size=[2, 3, 4, 5, 6], fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, hidden_dropout_prob=0.1, learning_rate=0.0001, local_rank=-1, logging_steps=100, max_grad_norm=1.0, max_seq_length=250, max_steps=-1, model_name='mutant_Bert_2seq_fold5_100_2506+10020_3_fold0', model_name_or_path='/data3/linming/DNABERT/examples/embeding_model/3-new-12w-0/', model_num=5, model_type='dna2seq_textcnn', n_gpu=1, n_process=8, no_cuda=False, num_rnn_layer=2, num_train_epochs=5.0, output_dir='/data3/linming/DNABERT/examples/output/fold5_100_2506+10020_3_2seq//_fold0', output_mode='classification', overwrite_cache=False, overwrite_output_dir=True, per_gpu_eval_batch_size=32, per_gpu_pred_batch_size=8, per_gpu_train_batch_size=32, predict_dir=None, predict_scan_size=1, result_dir=None, rnn='lstm', rnn_dropout=0.0, rnn_hidden=768, save_steps=4000, save_total_limit=None, seed=42, server_ip='', server_port='', should_continue=False, task_name='dnaprom', tokenizer_name='dna3', visualize_data_dir=None, visualize_models=None, visualize_train=False, warmup_percent=0.1, warmup_steps=0, weight_decay=0.01)
2023-10-25 21:45:30,124 - INFO - __main__ -   Creating features from dataset file at /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/before/
2023-10-25 21:45:33,741 - INFO - __main__ -   Saving features into cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/before/cached_train_3-new-12w-0_250_dnaprom
2023-10-25 21:45:36,247 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/after/cached_train_3-new-12w-0_250_dnaprom
2023-10-25 21:45:37,984 - INFO - __main__ -   ***** Running training *****
2023-10-25 21:45:37,985 - INFO - __main__ -     Num examples = 314
2023-10-25 21:45:37,985 - INFO - __main__ -     Num Epochs = 5
2023-10-25 21:45:37,986 - INFO - __main__ -     Instantaneous batch size per GPU = 32
2023-10-25 21:45:37,986 - INFO - __main__ -     Total train batch size (w. parallel, distributed & accumulation) = 32
2023-10-25 21:45:37,986 - INFO - __main__ -     Gradient Accumulation steps = 1
2023-10-25 21:45:37,986 - INFO - __main__ -     Total optimization steps = 1570
2023-10-25 21:45:37,986 - INFO - __main__ -     Continuing training from checkpoint, will skip to saved global_step
2023-10-25 21:45:37,986 - INFO - __main__ -     Continuing training from epoch 0
2023-10-25 21:45:37,986 - INFO - __main__ -     Continuing training from global step 0
2023-10-25 21:45:37,986 - INFO - __main__ -     Will skip the first 0 steps in the first epoch
2023-10-25 21:47:12,769 - WARNING - __main__ -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
2023-10-25 21:47:25,423 - INFO - __main__ -   finish loading model
2023-10-25 21:47:27,375 - INFO - __main__ -   Training/evaluation parameters Namespace(adam_epsilon=1e-08, attention_probs_dropout_prob=0.1, beta1=0.9, beta2=0.999, cache_dir='', config_name='', data_dir='/data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/', data_dir_after='/data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/after/', data_dir_before='/data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/before/', device=device(type='cuda'), do_ensemble_pred=False, do_eval=True, do_lower_case=False, do_predict=False, do_train=True, do_visualize=False, early_stop=0, eval_all_checkpoints=False, evaluate_during_training=True, filter_num=128, filter_size=[2, 3, 4, 5, 6], fp16=False, fp16_opt_level='O1', gradient_accumulation_steps=1, hidden_dropout_prob=0.1, learning_rate=0.0001, local_rank=-1, logging_steps=100, max_grad_norm=1.0, max_seq_length=250, max_steps=-1, model_name='mutant_Bert_2seq_fold5_100_2506+10020_3_fold0', model_name_or_path='/data3/linming/DNABERT/examples/embeding_model/3-new-12w-0/', model_num=5, model_type='dna2seq_textcnn', n_gpu=1, n_process=8, no_cuda=False, num_rnn_layer=2, num_train_epochs=5.0, output_dir='/data3/linming/DNABERT/examples/output/fold5_100_2506+10020_3_2seq//_fold0', output_mode='classification', overwrite_cache=False, overwrite_output_dir=True, per_gpu_eval_batch_size=32, per_gpu_pred_batch_size=8, per_gpu_train_batch_size=32, predict_dir=None, predict_scan_size=1, result_dir=None, rnn='lstm', rnn_dropout=0.0, rnn_hidden=768, save_steps=4000, save_total_limit=None, seed=42, server_ip='', server_port='', should_continue=False, task_name='dnaprom', tokenizer_name='dna3', visualize_data_dir=None, visualize_models=None, visualize_train=False, warmup_percent=0.1, warmup_steps=0, weight_decay=0.01)
2023-10-25 21:47:27,376 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/before/cached_train_3-new-12w-0_250_dnaprom
2023-10-25 21:47:29,070 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/after/cached_train_3-new-12w-0_250_dnaprom
2023-10-25 21:47:30,536 - INFO - __main__ -   ***** Running training *****
2023-10-25 21:47:30,536 - INFO - __main__ -     Num examples = 314
2023-10-25 21:47:30,537 - INFO - __main__ -     Num Epochs = 5
2023-10-25 21:47:30,537 - INFO - __main__ -     Instantaneous batch size per GPU = 32
2023-10-25 21:47:30,537 - INFO - __main__ -     Total train batch size (w. parallel, distributed & accumulation) = 32
2023-10-25 21:47:30,537 - INFO - __main__ -     Gradient Accumulation steps = 1
2023-10-25 21:47:30,537 - INFO - __main__ -     Total optimization steps = 1570
2023-10-25 21:47:30,537 - INFO - __main__ -     Continuing training from checkpoint, will skip to saved global_step
2023-10-25 21:47:30,537 - INFO - __main__ -     Continuing training from epoch 0
2023-10-25 21:47:30,537 - INFO - __main__ -     Continuing training from global step 0
2023-10-25 21:47:30,537 - INFO - __main__ -     Will skip the first 0 steps in the first epoch
2023-10-25 21:47:54,267 - INFO - __main__ -   Creating features from dataset file at /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/before/
2023-10-25 21:47:56,795 - INFO - __main__ -   Saving features into cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/before/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:47:57,376 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/after/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:47:57,770 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-25 21:47:57,770 - INFO - __main__ -     Num examples = 2506
2023-10-25 21:47:57,770 - INFO - __main__ -     Batch size = 32
2023-10-25 21:48:09,785 - INFO - __main__ -   ***** Eval results  *****
2023-10-25 21:48:09,785 - INFO - __main__ -     acc = 0.8176376695929769
2023-10-25 21:48:09,785 - INFO - __main__ -     auc = 0.8913903868938188
2023-10-25 21:48:09,785 - INFO - __main__ -     f1 = 0.8167440099554981
2023-10-25 21:48:09,785 - INFO - __main__ -     mcc = 0.656330863066164
2023-10-25 21:48:09,785 - INFO - __main__ -     precision = 0.8336716706714984
2023-10-25 21:48:09,785 - INFO - __main__ -     recall = 0.8227500561751848
2023-10-25 21:48:09,786 - INFO - __main__ -   {"eval_acc": 0.8176376695929769, "eval_f1": 0.8167440099554981, "eval_mcc": 0.656330863066164, "eval_auc": 0.8913903868938188, "eval_precision": 0.8336716706714984, "eval_recall": 0.8227500561751848, "learning_rate": 6.369426751592356e-05, "loss": 0.6232451735436917, "step": 100}
2023-10-25 21:48:36,433 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/before/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:48:36,800 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/after/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:48:37,167 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-25 21:48:37,167 - INFO - __main__ -     Num examples = 2506
2023-10-25 21:48:37,167 - INFO - __main__ -     Batch size = 32
2023-10-25 21:48:49,043 - INFO - __main__ -   ***** Eval results  *****
2023-10-25 21:48:49,043 - INFO - __main__ -     acc = 0.840782122905028
2023-10-25 21:48:49,043 - INFO - __main__ -     auc = 0.905924758446705
2023-10-25 21:48:49,043 - INFO - __main__ -     f1 = 0.8407764182711868
2023-10-25 21:48:49,043 - INFO - __main__ -     mcc = 0.6843985121511876
2023-10-25 21:48:49,043 - INFO - __main__ -     precision = 0.8420306325024409
2023-10-25 21:48:49,043 - INFO - __main__ -     recall = 0.8423679627813867
2023-10-25 21:48:49,044 - INFO - __main__ -   {"eval_acc": 0.840782122905028, "eval_f1": 0.8407764182711868, "eval_mcc": 0.6843985121511876, "eval_auc": 0.905924758446705, "eval_precision": 0.8420306325024409, "eval_recall": 0.8423679627813867, "learning_rate": 9.695682944090589e-05, "loss": 0.6429922014474869, "step": 200}
2023-10-25 21:49:12,845 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/before/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:49:13,332 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/after/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:49:13,694 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-25 21:49:13,695 - INFO - __main__ -     Num examples = 2506
2023-10-25 21:49:13,695 - INFO - __main__ -     Batch size = 32
2023-10-25 21:49:25,623 - INFO - __main__ -   ***** Eval results  *****
2023-10-25 21:49:25,623 - INFO - __main__ -     acc = 0.8268156424581006
2023-10-25 21:49:25,624 - INFO - __main__ -     auc = 0.8969561986763084
2023-10-25 21:49:25,624 - INFO - __main__ -     f1 = 0.8262419120348921
2023-10-25 21:49:25,624 - INFO - __main__ -     mcc = 0.670856934767264
2023-10-25 21:49:25,624 - INFO - __main__ -     precision = 0.8395421245421245
2023-10-25 21:49:25,624 - INFO - __main__ -     recall = 0.8313646484454794
2023-10-25 21:49:25,624 - INFO - __main__ -   {"eval_acc": 0.8268156424581006, "eval_f1": 0.8262419120348921, "eval_mcc": 0.670856934767264, "eval_auc": 0.8969561986763084, "eval_precision": 0.8395421245421245, "eval_recall": 0.8313646484454794, "learning_rate": 8.987968860580326e-05, "loss": 0.6133128303289413, "step": 300}
2023-10-25 21:49:49,262 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/before/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:49:49,647 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/after/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:49:49,994 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-25 21:49:49,995 - INFO - __main__ -     Num examples = 2506
2023-10-25 21:49:49,995 - INFO - __main__ -     Batch size = 32
2023-10-25 21:50:01,945 - INFO - __main__ -   ***** Eval results  *****
2023-10-25 21:50:01,945 - INFO - __main__ -     acc = 0.8479648842777334
2023-10-25 21:50:01,945 - INFO - __main__ -     auc = 0.9119415675940679
2023-10-25 21:50:01,945 - INFO - __main__ -     f1 = 0.8478805650551935
2023-10-25 21:50:01,945 - INFO - __main__ -     mcc = 0.7042718064220276
2023-10-25 21:50:01,945 - INFO - __main__ -     precision = 0.8533155322492023
2023-10-25 21:50:01,945 - INFO - __main__ -     recall = 0.8509602126486089
2023-10-25 21:50:01,946 - INFO - __main__ -   {"eval_acc": 0.8479648842777334, "eval_f1": 0.8478805650551935, "eval_mcc": 0.7042718064220276, "eval_auc": 0.9119415675940679, "eval_precision": 0.8533155322492023, "eval_recall": 0.8509602126486089, "learning_rate": 8.280254777070065e-05, "loss": 0.5450791159272194, "step": 400}
2023-10-25 21:50:25,815 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/before/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:50:26,181 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/after/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:50:26,663 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-25 21:50:26,664 - INFO - __main__ -     Num examples = 2506
2023-10-25 21:50:26,664 - INFO - __main__ -     Batch size = 32
2023-10-25 21:50:38,629 - INFO - __main__ -   ***** Eval results  *****
2023-10-25 21:50:38,629 - INFO - __main__ -     acc = 0.8387869114126097
2023-10-25 21:50:38,629 - INFO - __main__ -     auc = 0.8646133359888876
2023-10-25 21:50:38,629 - INFO - __main__ -     f1 = 0.8382821899305416
2023-10-25 21:50:38,629 - INFO - __main__ -     mcc = 0.6946292461722597
2023-10-25 21:50:38,629 - INFO - __main__ -     precision = 0.8513893027218886
2023-10-25 21:50:38,629 - INFO - __main__ -     recall = 0.8432871930792172
2023-10-25 21:50:38,630 - INFO - __main__ -   {"eval_acc": 0.8387869114126097, "eval_f1": 0.8382821899305416, "eval_mcc": 0.6946292461722597, "eval_auc": 0.8646133359888876, "eval_precision": 0.8513893027218886, "eval_recall": 0.8432871930792172, "learning_rate": 7.572540693559802e-05, "loss": 0.5374727261066437, "step": 500}
2023-10-25 21:51:02,530 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/before/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:51:02,892 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/after/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:51:03,274 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-25 21:51:03,275 - INFO - __main__ -     Num examples = 2506
2023-10-25 21:51:03,275 - INFO - __main__ -     Batch size = 32
2023-10-25 21:51:15,243 - INFO - __main__ -   ***** Eval results  *****
2023-10-25 21:51:15,243 - INFO - __main__ -     acc = 0.8288108539505188
2023-10-25 21:51:15,243 - INFO - __main__ -     auc = 0.8903837020468194
2023-10-25 21:51:15,244 - INFO - __main__ -     f1 = 0.8274444581944357
2023-10-25 21:51:15,244 - INFO - __main__ -     mcc = 0.6865752455830186
2023-10-25 21:51:15,244 - INFO - __main__ -     precision = 0.8519357792933173
2023-10-25 21:51:15,244 - INFO - __main__ -     recall = 0.8348519783878743
2023-10-25 21:51:15,244 - INFO - __main__ -   {"eval_acc": 0.8288108539505188, "eval_f1": 0.8274444581944357, "eval_mcc": 0.6865752455830186, "eval_auc": 0.8903837020468194, "eval_precision": 0.8519357792933173, "eval_recall": 0.8348519783878743, "learning_rate": 6.864826610049541e-05, "loss": 0.5126166880130768, "step": 600}
2023-10-25 21:51:38,940 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/before/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:51:39,307 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/after/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:51:39,672 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-25 21:51:39,672 - INFO - __main__ -     Num examples = 2506
2023-10-25 21:51:39,673 - INFO - __main__ -     Batch size = 32
2023-10-25 21:51:51,656 - INFO - __main__ -   ***** Eval results  *****
2023-10-25 21:51:51,657 - INFO - __main__ -     acc = 0.8619313647246608
2023-10-25 21:51:51,657 - INFO - __main__ -     auc = 0.9135744780814643
2023-10-25 21:51:51,657 - INFO - __main__ -     f1 = 0.8617833769466592
2023-10-25 21:51:51,657 - INFO - __main__ -     mcc = 0.7239232188869097
2023-10-25 21:51:51,657 - INFO - __main__ -     precision = 0.8616210464612484
2023-10-25 21:51:51,657 - INFO - __main__ -     recall = 0.862302493156841
2023-10-25 21:51:51,658 - INFO - __main__ -   {"eval_acc": 0.8619313647246608, "eval_f1": 0.8617833769466592, "eval_mcc": 0.7239232188869097, "eval_auc": 0.9135744780814643, "eval_precision": 0.8616210464612484, "eval_recall": 0.862302493156841, "learning_rate": 6.157112526539278e-05, "loss": 0.4844907905161381, "step": 700}
2023-10-25 21:52:15,807 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/before/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:52:16,160 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/after/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:52:16,567 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-25 21:52:16,567 - INFO - __main__ -     Num examples = 2506
2023-10-25 21:52:16,567 - INFO - __main__ -     Batch size = 32
2023-10-25 21:52:28,525 - INFO - __main__ -   ***** Eval results  *****
2023-10-25 21:52:28,525 - INFO - __main__ -     acc = 0.8455706304868316
2023-10-25 21:52:28,525 - INFO - __main__ -     auc = 0.9079384473178903
2023-10-25 21:52:28,525 - INFO - __main__ -     f1 = 0.8447963714733304
2023-10-25 21:52:28,526 - INFO - __main__ -     mcc = 0.7135583291214789
2023-10-25 21:52:28,526 - INFO - __main__ -     precision = 0.8628780839892414
2023-10-25 21:52:28,526 - INFO - __main__ -     recall = 0.8507827501327777
2023-10-25 21:52:28,526 - INFO - __main__ -   {"eval_acc": 0.8455706304868316, "eval_f1": 0.8447963714733304, "eval_mcc": 0.7135583291214789, "eval_auc": 0.9079384473178903, "eval_precision": 0.8628780839892414, "eval_recall": 0.8507827501327777, "learning_rate": 5.449398443029017e-05, "loss": 0.46239395409822465, "step": 800}
2023-10-25 21:52:52,478 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/before/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:52:52,849 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/after/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:52:53,225 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-25 21:52:53,225 - INFO - __main__ -     Num examples = 2506
2023-10-25 21:52:53,225 - INFO - __main__ -     Batch size = 32
2023-10-25 21:53:05,189 - INFO - __main__ -   ***** Eval results  *****
2023-10-25 21:53:05,189 - INFO - __main__ -     acc = 0.8355945730247406
2023-10-25 21:53:05,189 - INFO - __main__ -     auc = 0.8989344588797646
2023-10-25 21:53:05,189 - INFO - __main__ -     f1 = 0.8352415512129423
2023-10-25 21:53:05,189 - INFO - __main__ -     mcc = 0.6852342495673489
2023-10-25 21:53:05,189 - INFO - __main__ -     precision = 0.8456246134817563
2023-10-25 21:53:05,189 - INFO - __main__ -     recall = 0.8396358060628345
2023-10-25 21:53:05,190 - INFO - __main__ -   {"eval_acc": 0.8355945730247406, "eval_f1": 0.8352415512129423, "eval_mcc": 0.6852342495673489, "eval_auc": 0.8989344588797646, "eval_precision": 0.8456246134817563, "eval_recall": 0.8396358060628345, "learning_rate": 4.741684359518755e-05, "loss": 0.39888780638575555, "step": 900}
2023-10-25 21:53:28,827 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/before/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:53:29,273 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/after/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:53:29,668 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-25 21:53:29,668 - INFO - __main__ -     Num examples = 2506
2023-10-25 21:53:29,668 - INFO - __main__ -     Batch size = 32
2023-10-25 21:53:41,641 - INFO - __main__ -   ***** Eval results  *****
2023-10-25 21:53:41,642 - INFO - __main__ -     acc = 0.8683160415003991
2023-10-25 21:53:41,642 - INFO - __main__ -     auc = 0.927052373146219
2023-10-25 21:53:41,642 - INFO - __main__ -     f1 = 0.8682548684747144
2023-10-25 21:53:41,642 - INFO - __main__ -     mcc = 0.7376440467902724
2023-10-25 21:53:41,642 - INFO - __main__ -     precision = 0.868415856467327
2023-10-25 21:53:41,642 - INFO - __main__ -     recall = 0.8692286381092454
2023-10-25 21:53:41,642 - INFO - __main__ -   {"eval_acc": 0.8683160415003991, "eval_f1": 0.8682548684747144, "eval_mcc": 0.7376440467902724, "eval_auc": 0.927052373146219, "eval_precision": 0.868415856467327, "eval_recall": 0.8692286381092454, "learning_rate": 4.033970276008493e-05, "loss": 0.4185365230590105, "step": 1000}
2023-10-25 21:54:05,526 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/before/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:54:05,883 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/after/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:54:06,271 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-25 21:54:06,272 - INFO - __main__ -     Num examples = 2506
2023-10-25 21:54:06,272 - INFO - __main__ -     Batch size = 32
2023-10-25 21:54:18,233 - INFO - __main__ -   ***** Eval results  *****
2023-10-25 21:54:18,234 - INFO - __main__ -     acc = 0.8379888268156425
2023-10-25 21:54:18,234 - INFO - __main__ -     auc = 0.910113959022756
2023-10-25 21:54:18,234 - INFO - __main__ -     f1 = 0.837496038966349
2023-10-25 21:54:18,234 - INFO - __main__ -     mcc = 0.6927553223885173
2023-10-25 21:54:18,234 - INFO - __main__ -     precision = 0.8503507053291536
2023-10-25 21:54:18,234 - INFO - __main__ -     recall = 0.8424496721411938
2023-10-25 21:54:18,234 - INFO - __main__ -   {"eval_acc": 0.8379888268156425, "eval_f1": 0.837496038966349, "eval_mcc": 0.6927553223885173, "eval_auc": 0.910113959022756, "eval_precision": 0.8503507053291536, "eval_recall": 0.8424496721411938, "learning_rate": 3.326256192498231e-05, "loss": 0.3844659668207169, "step": 1100}
2023-10-25 21:54:42,092 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/before/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:54:42,458 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/after/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:54:43,011 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-25 21:54:43,011 - INFO - __main__ -     Num examples = 2506
2023-10-25 21:54:43,011 - INFO - __main__ -     Batch size = 32
2023-10-25 21:54:55,031 - INFO - __main__ -   ***** Eval results  *****
2023-10-25 21:54:55,032 - INFO - __main__ -     acc = 0.859537110933759
2023-10-25 21:54:55,032 - INFO - __main__ -     auc = 0.9165891066102873
2023-10-25 21:54:55,032 - INFO - __main__ -     f1 = 0.859456545083866
2023-10-25 21:54:55,032 - INFO - __main__ -     mcc = 0.7198353182202974
2023-10-25 21:54:55,032 - INFO - __main__ -     precision = 0.859518550223948
2023-10-25 21:54:55,032 - INFO - __main__ -     recall = 0.8603172110552764
2023-10-25 21:54:55,032 - INFO - __main__ -   {"eval_acc": 0.859537110933759, "eval_f1": 0.859456545083866, "eval_mcc": 0.7198353182202974, "eval_auc": 0.9165891066102873, "eval_precision": 0.859518550223948, "eval_recall": 0.8603172110552764, "learning_rate": 2.6185421089879692e-05, "loss": 0.38158957436680796, "step": 1200}
2023-10-25 21:55:18,843 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/before/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:55:19,235 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/after/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:55:19,608 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-25 21:55:19,609 - INFO - __main__ -     Num examples = 2506
2023-10-25 21:55:19,609 - INFO - __main__ -     Batch size = 32
2023-10-25 21:55:31,601 - INFO - __main__ -   ***** Eval results  *****
2023-10-25 21:55:31,601 - INFO - __main__ -     acc = 0.8659217877094972
2023-10-25 21:55:31,601 - INFO - __main__ -     auc = 0.9205650968255914
2023-10-25 21:55:31,601 - INFO - __main__ -     f1 = 0.8657164291072768
2023-10-25 21:55:31,601 - INFO - __main__ -     mcc = 0.7315434588566853
2023-10-25 21:55:31,601 - INFO - __main__ -     precision = 0.8655431217835265
2023-10-25 21:55:31,601 - INFO - __main__ -     recall = 0.8660004800424889
2023-10-25 21:55:31,602 - INFO - __main__ -   {"eval_acc": 0.8659217877094972, "eval_f1": 0.8657164291072768, "eval_mcc": 0.7315434588566853, "eval_auc": 0.9205650968255914, "eval_precision": 0.8655431217835265, "eval_recall": 0.8660004800424889, "learning_rate": 1.910828025477707e-05, "loss": 0.3502362105995417, "step": 1300}
2023-10-25 21:55:55,530 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/before/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:55:55,887 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/after/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:55:56,245 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-25 21:55:56,245 - INFO - __main__ -     Num examples = 2506
2023-10-25 21:55:56,245 - INFO - __main__ -     Batch size = 32
2023-10-25 21:56:08,225 - INFO - __main__ -   ***** Eval results  *****
2023-10-25 21:56:08,225 - INFO - __main__ -     acc = 0.8655227454110136
2023-10-25 21:56:08,225 - INFO - __main__ -     auc = 0.9202398552722963
2023-10-25 21:56:08,225 - INFO - __main__ -     f1 = 0.8654579384997095
2023-10-25 21:56:08,225 - INFO - __main__ -     mcc = 0.7320114869393113
2023-10-25 21:56:08,225 - INFO - __main__ -     precision = 0.8656016300709621
2023-10-25 21:56:08,225 - INFO - __main__ -     recall = 0.8664103035502717
2023-10-25 21:56:08,225 - INFO - __main__ -   {"eval_acc": 0.8655227454110136, "eval_f1": 0.8654579384997095, "eval_mcc": 0.7320114869393113, "eval_auc": 0.9202398552722963, "eval_precision": 0.8656016300709621, "eval_recall": 0.8664103035502717, "learning_rate": 1.2031139419674452e-05, "loss": 0.3249014485627413, "step": 1400}
2023-10-25 21:56:32,239 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/before/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:56:32,602 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/after/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:56:32,956 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-25 21:56:32,956 - INFO - __main__ -     Num examples = 2506
2023-10-25 21:56:32,956 - INFO - __main__ -     Batch size = 32
2023-10-25 21:56:44,962 - INFO - __main__ -   ***** Eval results  *****
2023-10-25 21:56:44,962 - INFO - __main__ -     acc = 0.8603351955307262
2023-10-25 21:56:44,962 - INFO - __main__ -     auc = 0.9192433840952731
2023-10-25 21:56:44,962 - INFO - __main__ -     f1 = 0.8602066219761374
2023-10-25 21:56:44,962 - INFO - __main__ -     mcc = 0.7208974452931012
2023-10-25 21:56:44,963 - INFO - __main__ -     precision = 0.8600820528501898
2023-10-25 21:56:44,963 - INFO - __main__ -     recall = 0.8608157658209747
2023-10-25 21:56:44,963 - INFO - __main__ -   {"eval_acc": 0.8603351955307262, "eval_f1": 0.8602066219761374, "eval_mcc": 0.7208974452931012, "eval_auc": 0.9192433840952731, "eval_precision": 0.8600820528501898, "eval_recall": 0.8608157658209747, "learning_rate": 4.953998584571833e-06, "loss": 0.32226768106222153, "step": 1500}
2023-10-25 21:57:01,765 - INFO - __main__ -    global_step = 1570, average loss = 0.46073425846874333
2023-10-25 21:57:01,765 - INFO - __main__ -   Saving model checkpoint to /data3/linming/DNABERT/examples/output/fold5_100_2506+10020_3_2seq//_fold0
2023-10-25 21:57:04,406 - INFO - __main__ -   Evaluate the following checkpoints: ['/data3/linming/DNABERT/examples/output/fold5_100_2506+10020_3_2seq//_fold0']
2023-10-25 21:57:06,640 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/before/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:57:07,024 - INFO - __main__ -   Loading features from cached file /data3/linming/DNABERT/examples/data/fold5_100_2506+10020_3/0/after/cached_dev_3-new-12w-0_250_dnaprom
2023-10-25 21:57:07,392 - INFO - __main__ -   ***** Running evaluation  *****
2023-10-25 21:57:07,392 - INFO - __main__ -     Num examples = 2506
2023-10-25 21:57:07,392 - INFO - __main__ -     Batch size = 32
2023-10-25 21:57:19,353 - INFO - __main__ -   ***** Eval results  *****
2023-10-25 21:57:19,353 - INFO - __main__ -     acc = 0.8643256185155627
2023-10-25 21:57:19,353 - INFO - __main__ -     auc = 0.921280053723904
2023-10-25 21:57:19,353 - INFO - __main__ -     f1 = 0.8641262227268522
2023-10-25 21:57:19,353 - INFO - __main__ -     mcc = 0.7283860125370534
2023-10-25 21:57:19,353 - INFO - __main__ -     precision = 0.8639477509179927
2023-10-25 21:57:19,353 - INFO - __main__ -     recall = 0.8644384268905503
